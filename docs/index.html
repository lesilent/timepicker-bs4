<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>timepicker-bs4</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.2/css/bootstrap.min.css" integrity="sha512-rt/SrQ4UNIaGfDyEXZtNcyWvQeOq0QLygHluFQcSjaGB04IxWhal71tKuzP6K8eYXYB6vJV4pHkXcmFGGQ1/0w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer" defer="defer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.2/js/bootstrap.bundle.min.js" integrity="sha512-igl8WEUuas9k5dtnhKqyyld6TzzRjvMqLC79jkgT3z02FvJyHAuUtyemm/P/jYSne1xwFI06ezQxEwweaiV7VA==" crossorigin="anonymous" referrerpolicy="no-referrer" defer="defer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.11.10/dayjs.min.js" integrity="sha512-FwNWaxyfy2XlEINoSnZh1JQ5TRRtGow0D6XcmAWmYCRgvqOUTnzCxPc9uF35u5ZEpirk1uhlPVA19tflhvnW1g==" crossorigin="anonymous" referrerpolicy="no-referrer" defer="defer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.11.10/plugin/customParseFormat.min.js" integrity="sha512-FM59hRKwY7JfAluyciYEi3QahhG/wPBo6Yjv6SaPsh061nFDVSukJlpN+4Ow5zgNyuDKkP3deru35PHOEncwsw==" crossorigin="anonymous" referrerpolicy="no-referrer" defer="defer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/js/all.min.js" integrity="sha512-Tn2m0TIpgVyTzzvmxLNuqbSJH3JP8jm+Cy3hvHrW7ndTDcJ1w5mBiksqDBb8GpE2ksktFvDB/ykZ0mDpsZj20w==" crossorigin="anonymous" referrerpolicy="no-referrer" defer="defer"></script>
<script src="js/timepicker-bs4.js?" defer="defer"></script>
<style>
.form-control::placeholder {
	opacity: 0.5 !important;
}
</style>
</head>
<body>
<div class="container py-3">
<div class="d-flex justify-content-between">
	<div><h1 class="display-4">timepicker-bs4</h1></div>
	<div><a href="https://github.com/lesilent/timepicker-bs4" title="timepicker-bs4 on GitHub"><i class="fab fa-github fa-lg m-2"></i></a></div>
</div><!-- /.d-flex -->
<div class="list-group">
<div class="list-group-item bg-light font-weight-bolder">Options</div>
<div class="list-group-item"><form id="custom-form" autocomplete="off" onsubmit="return false">
<div class="row">
	<div class="form-group col-6 col-sm-4 col-md-3">
		<label for="id">ID:</label>
		<div class="input-group">
		<input type="text" id="id" class="form-control options-control" name="id" value="" maxlength="64" />
		<div class="input-group-append"><button type="button" id="id-reset-btn" class="btn btn-outline-secondary reset-btn" disabled="disabled" title="Reset ID"><i class="far fa-times-circle"></i></button></div>
		</div><!-- /.input-group -->
	</div><!-- /.form-group -->
	<div class="form-group col-6 col-sm-4 col-md-3">
		<label for="name">Name:</label>
		<div class="input-group">
		<input type="text" id="name" class="form-control options-control" name="name" value="" maxlength="64" autocomplete="off" />
		<div class="input-group-append"><button type="button" id="name-reset-btn" class="btn btn-outline-secondary reset-btn" disabled="disabled" title="Reset Name"><i class="far fa-times-circle"></i></button></div>
		</div><!-- /.input-group -->
	</div><!-- /.form-group -->
	<div class="form-group col-6 col-sm-4 col-md-3">
		<label for="format">Format:</label>
		<div class="input-group">
		<input type="text" id="format" class="form-control options-control" name="format" value="hh:mm A" readonly="readonly" />
		<div class="input-group-append">
		<button type="button" class="btn btn-outline-secondary dropdown-toggle" data-toggle="dropdown" aria-expanded="false"></button>
		<div id="format-dropdown-menu" class="dropdown-menu dropdown-menu-right">
			<button type="button" class="dropdown-item">hh:mm A</button>
			<button type="button" class="dropdown-item">HH:mm</button>
			<button type="button" class="dropdown-item">HH:mm:ss</button>
		</div><!-- /.dropdown-menu -->
		</div><!-- /.input-group-append -->
		</div><!-- /.input-group -->
	</div><!-- /.form-group -->
	<div class="form-group col-6 col-sm-4 col-md-3">
		<label for="defaultTime">Default Time:</label>
		<div class="input-group">
		<input type="text" id="defaultTime" class="form-control options-control" name="defaultTime" placeholder="HH:mm" pattern="(([01][0-9]|2[0-3]):[0-5][0-9])?" maxlength="5" data-format="HH:mm" data-default="09:00" />
		<div class="input-group-append"><button type="button" id="defaultTime-reset-btn" class="btn btn-outline-secondary reset-btn" disabled="disabled" title="Reset Option"><i class="far fa-times-circle"></i></button></div>
		</div><!-- /.input-group -->
	</div><!-- /.form-group -->
	<div class="form-group col-6 col-sm-4 col-md-3">
		<label for="minTime">Min Time:</label>
		<div class="input-group">
		<input type="text" id="minTime" class="form-control options-control" name="minTime" placeholder="HH:mm" pattern="(([01][0-9]|2[0-3]):[0-5][0-9])?" maxlength="5" data-format="HH:mm" />
		<div class="input-group-append"><button type="button" id="minTime-reset-btn" class="btn btn-outline-secondary reset-btn" disabled="disabled" title="Reset Option"><i class="far fa-times-circle"></i></button></div>
		</div><!-- /.input-group -->
	</div><!-- /.form-group -->
	<div class="form-group col-6 col-sm-4 col-md-3">
		<label for="maxTime">Max Time:</label>
		<div class="input-group">
		<input type="text" id="maxTime" class="form-control options-control" name="maxTime" placeholder="HH:mm" pattern="(([01][0-9]|2[0-3]):[0-5][0-9])?" maxlength="5" data-format="HH:mm" />
		<div class="input-group-append"><button type="button" id="maxTime-reset-btn" class="btn btn-outline-secondary reset-btn" disabled="disabled" title="Reset Option"><i class="far fa-times-circle"></i></button></div>
		</div><!-- /.input-group -->
	</div><!-- /.form-group -->
	<div class="form-group col-6 col-sm-4 col-md-3">
		<label for="step">Step (seconds):</label>
		<div class="input-group">
		<input type="number" id="step" class="form-control options-control" name="step" min="60" max="86399" pattern="(\d{1,5})?" maxlength="5" data-prev="60" />
		<div class="input-group-append"><button type="button" id="step-reset-btn" class="btn btn-outline-secondary reset-btn" disabled="disabled" title="Reset Option"><i class="far fa-times-circle"></i></button></div>
		</div><!-- /.input-group -->
	</div><!-- /.form-group -->
	<div class="form-group col-6 col-sm-4 col-md-3">
		<label for="scheme">Scheme:</label>
		<div class="input-group">
		<select id="scheme" class="form-control options-control" name="scheme">
		<option value="">light</option>
		<option value="dark">dark</option>
		<option value="auto">auto</option>
		</select>
		<div class="input-group-append"><button type="button" id="scheme-reset-btn" class="btn btn-outline-secondary reset-btn" disabled="disabled" title="Reset Scheme"><i class="far fa-times-circle"></i></button></div>
		</div><!-- /.input-group -->
	</div><!-- /.form-group -->
	<div class="form-group col-6 col-sm-4 col-md-3">
		<label for="togglebtn">Toggle Button:</label>
		<select id="togglebtn" class="form-control options-control" name="togglebtn">
		<option value="0">No</option>
		<option value="1">Yes</option>
		</select>
	</div><!-- /.form-group -->
	<div class="form-group col-6 col-sm-4 col-md-3">
		<label for="paramtype">Options:</label>
		<select id="paramtype" class="form-control options-control" name="paramtype">
		<option value="HTML">HTML</option>
		<option value="JS">JavaScript</option>
		</select>
	</div><!-- /.form-group -->
</div><!-- /.row -->
</form></div>
<div class="list-group-item bg-light font-weight-bolder">Result</div>
<div class="list-group-item">
	<form class="form-inline" autocomplete="off" onsubmit="return false">
	<label id="timepicker-input-label" class="mr-sm-2 sr-only" for="timepicker-input">Time:</label>
	<input type="text" id="timepicker-input" class="form-control timepicker-input" name="time" value="" size="10" autocomplete="off" />
	<label id="timepicker-input-group-label" class="mr-sm-2 sr-only" for="timepicker-input-group">Time:</label>
	<div class="input-group timepicker-input-group d-none">
		<input type="text" id="timepicker-input-group" class="form-control timepicker-input" name="time" value="" size="10" autocomplete="off" />
		<div class="input-group-append"><button type="button" class="btn btn-outline-secondary" data-toggle="timepicker" data-target="#timepicker-input-group" title="Time"><i class="far fa-clock"></i></button></div>
	</div><!-- /.input-group -->
	</form>
</div><!-- /.list-group-item -->
<div class="list-group-item bg-light font-weight-bolder">HTML</div>
<div class="list-group-item"><pre class="mb-0" tabindex="-1"><code id="timepicker-html"><span class="timepicker-input-group d-none">&lt;div class=&quot;input-group&quot;&gt;</span>
<span id="timepicker-indent" class="d-none">  </span>&lt;input type=&quot;text&quot;<span id="timepicker-id"></span><span id="timepicker-name"></span> class=&quot;form-control timepicker-bs4&quot;<span id="timepicker-attribs"></span> /&gt;
    <span class="timepicker-input-group d-none">&lt;div class=&quot;input-group-append&quot;&gt;
      &lt;button type=&quot;button&quot; class=&quot;btn btn-outline-secondary&quot; data-toggle=&quot;timepicker&quot;<span id="timepicker-target"></span>&gt;&lt;i class=&quot;far fa-clock&quot;&gt;&lt;/i&gt;&lt;/button&gt;
    &lt;/div&gt;
&lt;/div&gt;</span></code></pre></div>
<div class="list-group-item bg-light font-weight-bolder">JavaScript</div>
<div class="list-group-item"><pre class="mb-0"><code id="timepicker-javascript">jQuery('input.timepicker-bs4').timepicker(<span id="timepicker-params"></span>);</code></pre></div>
</div><!-- /.list-group -->
</div><!-- /.container -->
<script>
document.addEventListener('DOMContentLoaded', function () {
	// Load Day.js plugins
	['custom'].forEach(function (format) {
		const plugin = 'dayjs_plugin_customFormat';
		if (plugin in window)
		{
			dayjs.extend(window[plugin]);
		}
	});

	jQuery('#defaultTime, #minTime, #maxTime').timepicker();
	const $picker = jQuery('#timepicker-input').timepicker();
	const $step = jQuery('#step');
	const defaultFormat = $picker.timepicker('format');
	const defaultScheme = $picker.timepicker('scheme') || '';
	const minStep = parseInt(document.getElementById('step').min);
	const maxStep = parseInt(document.getElementById('step').max);
	const timeRegex = new RegExp('^' + document.getElementById('minTime').pattern.replace(/\?$/, '') + '$');
	let has_second = false;
	jQuery('.options-control').on('change', function () {
		if (this.type == 'text')
		{
			this.value = this.value.replace(/^\s+|\s+$/, '');
		}
		let this_value = this.value;
		switch (this.id)
		{
			case 'id':
				this_value = this_value.replace(/[^\w\-\.:]+/g, '').replace(/^[^a-z]+/i, '');
				document.getElementById('timepicker-id').textContent = (this_value.length > 0) ? ' id="' + this.value + '"' : '';
				document.getElementById('timepicker-target').textContent = (this_value.length > 0) ? ' data-target="#' + this.value + '"' : '';
				document.getElementById('id-reset-btn').disabled = !(this_value.length > 0);
				this.value = this_value;
				break;
			case 'name':
				this_value = this.value.replace(/[^\w\-\.:]+/g, '').replace(/^[^a-z]+/i, '');;
				document.getElementById('timepicker-name').textContent = (this_value.length > 0) ? ' name="' + this.value + '"' : '';
				document.getElementById('name-reset-btn').disabled = !(this_value.length > 0);
				this.value = this_value;
				break;
			case 'format':
				$picker.val('').timepicker('time', null);
				has_second = (document.getElementById('format').value.replace(/\[[^\]]*\]/g).indexOf('s') >= 0);
				if (!has_second)
				{
					let step = parseInt($step.val());
					if (step % 60 > 0)
					{
						step = Math.round(step / 60) * 60;
						$step.data('prev', step).val(step.toString());
					}
				}
				break;
			case 'defaultTime':
			case 'maxTime':
			case 'minTime':
				if (!timeRegex.test(this_value))
				{
					this_value = '';
				}
				document.getElementById(this.id + '-reset-btn').disabled = !(this_value.length > 0);
				this.value = this_value;
				break;
			case 'step':
				this_value = this_value.replace(/\D+/g, '');
				if (this_value.length > 0)
				{
					const prev_value = $step.data('prev');
					this_value = parseInt(this_value);
					if (!has_second && this_value != prev_value)
					{
						this_value = ((this_value > prev_value) ? Math.ceil(this_value / 60) : Math.floor(this_value / 60)) * 60;
					}
					this_value = (this_value < 0 || this_value < minStep || this_value > maxStep) ? '' : this_value.toString();
				}
				document.getElementById('step-reset-btn').disabled = !(this_value.length > 0);
				this.value = this_value;
				$step.data('prev', this_value);
				break;
			case 'scheme':
				document.getElementById('scheme-reset-btn').disabled = !(this_value.length > 0);
				break;
		}
		let attribs = '', options = {};
		jQuery.each({ format: 'format', defaultTime: 'default', minTime: 'min', maxTime: 'max', step: 'step', scheme: 'scheme' }, function (option, attr) {
			const input = document.getElementById(option);
			const value = input.value;
			jQuery('.timepicker-input').timepicker(option, value);
			if (value.length > 0 && !(option == 'format' && value == defaultFormat) && !(option == 'scheme' && value == defaultScheme))
			{
				options[option] = value;
				attribs += ' ' + ((attr == 'format' || attr == 'default' || attr == 'scheme') ? 'data-' : '') + attr + '="' + value + '"';
			}
		});
		const paramtype = document.getElementById('paramtype').value;
		const togglebtn = (document.getElementById('togglebtn').selectedIndex > 0);
		jQuery('.timepicker-input-group').toggleClass('d-none', !togglebtn);
		$picker.toggleClass('d-none', togglebtn);
		jQuery('#timepicker-indent').toggleClass('d-none', !togglebtn);
		document.getElementById('timepicker-attribs').textContent = (paramtype == 'HTML') ? attribs : '';
		document.getElementById('timepicker-params').textContent = (paramtype == 'JS' && attribs.length > 0) ? JSON.stringify(options, null, "\t").replace(/"([^"]+)":/g, '$1:') : '';
	});
	const $format = jQuery('#format').val(defaultFormat).prop('readOnly', false);
	jQuery('#format-dropdown-menu').find('button').on('click', function () {
		$format.val(this.textContent).trigger('change');
	});
	jQuery('.reset-btn').on('click', function () {
		jQuery('#' + this.id.substring(0, this.id.length - 10)).val('').trigger('change');
		this.disabled = true;
	});
});
</script>
</body>
</html>
